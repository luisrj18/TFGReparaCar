<div class="workshop-container">
  <div class="workshop-card">
    <div class="workshop-header">
      <h1 *ngIf="cliente.cif==null">Registra tu Taller</h1>
      <p *ngIf="cliente.cif==null">Complete el formulario para registrar su taller en ReparaCar</p>
       <h1 *ngIf="cliente.cif!=null">Datos de tu Taller</h1>
      <p *ngIf="cliente.cif!=null">Datos registrados de su taller en ReparaCar</p>
    </div>

    <form [formGroup]="tallerForm" (ngSubmit)="onSubmit()" class="workshop-form">
      
      <div class="form-group-row">
        <div class="form-group">
          <label for="nombre">Nombre del taller</label>
          <input 
            type="text" id="nombre" formControlName="nombre"
            placeholder="Ingrese el nombre del taller"
            [class.is-invalid]="tallerForm.get('nombre')?.invalid && tallerForm.get('nombre')?.touched">
          <div class="error-message" *ngIf="tallerForm.get('nombre')?.invalid && tallerForm.get('nombre')?.touched">
            <span *ngIf="tallerForm.get('nombre')?.errors?.['required']">El nombre es requerido</span>
            <span *ngIf="tallerForm.get('nombre')?.errors?.['minlength']">Mínimo 2 caracteres</span>
          </div>
        </div>

        <div class="form-group">
          <label for="cif">CIF</label>
          <input 
            type="text" id="cif" formControlName="cif"
            placeholder="Ingrese el CIF"
            [class.is-invalid]="tallerForm.get('cif')?.invalid && tallerForm.get('cif')?.touched">
          <div class="error-message" *ngIf="tallerForm.get('cif')?.invalid && tallerForm.get('cif')?.touched">
            <span *ngIf="tallerForm.get('cif')?.errors?.['required']">El CIF es requerido</span>
            <span *ngIf="tallerForm.get('cif')?.errors?.['pattern']">Formato de CIF no válido</span>
          </div>
        </div>
      </div>

      <div class="form-group-row">
        <div class="form-group">
          <label for="email">Correo electrónico</label>
          <input 
            type="email" id="email" formControlName="email"
            placeholder="correo@taller.com"
            [class.is-invalid]="tallerForm.get('email')?.invalid && tallerForm.get('email')?.touched">
          <div class="error-message" *ngIf="tallerForm.get('email')?.invalid && tallerForm.get('email')?.touched">
            <span *ngIf="tallerForm.get('email')?.errors?.['required']">El correo es requerido</span>
            <span *ngIf="tallerForm.get('email')?.errors?.['email']">Formato no válido</span>
          </div>
        </div>

        <div class="form-group">
          <label for="telefono">Teléfono</label>
          <input 
            type="tel" id="telefono" formControlName="telefono"
            placeholder="Ingrese el teléfono"
            [class.is-invalid]="tallerForm.get('telefono')?.invalid && tallerForm.get('telefono')?.touched">
          <div class="error-message" *ngIf="tallerForm.get('telefono')?.invalid && tallerForm.get('telefono')?.touched">
            <span *ngIf="tallerForm.get('telefono')?.errors?.['required']">El teléfono es requerido</span>
            <span *ngIf="tallerForm.get('telefono')?.errors?.['pattern']">Formato no válido</span>
          </div>
        </div>
      </div>

      <div class="form-group-row">
        <div class="form-group">
          <label for="password">Contraseña</label>
          <input 
            type="password" id="password" formControlName="password"
            placeholder="Ingrese una contraseña"
            [class.is-invalid]="tallerForm.get('password')?.invalid && tallerForm.get('password')?.touched">
          <div class="error-message" *ngIf="tallerForm.get('password')?.invalid && tallerForm.get('password')?.touched">
            <span *ngIf="tallerForm.get('password')?.errors?.['required']">La contraseña es requerida</span>
            <span *ngIf="tallerForm.get('password')?.errors?.['minlength']">Mínimo 8 caracteres</span>
          </div>
        </div>

        <div class="form-group">
          <label for="confirmPassword">Confirmar contraseña</label>
          <input 
            type="password" id="confirmPassword" formControlName="confirmPassword"
            placeholder="Confirme su contraseña"
            [class.is-invalid]="tallerForm.get('confirmPassword')?.invalid && tallerForm.get('confirmPassword')?.touched">
          <div class="error-message" *ngIf="tallerForm.get('confirmPassword')?.invalid && tallerForm.get('confirmPassword')?.touched">
            <span *ngIf="tallerForm.get('confirmPassword')?.errors?.['required']">Confirme su contraseña</span>
            <span *ngIf="tallerForm.get('confirmPassword')?.errors?.['passwordMismatch']">Las contraseñas no coinciden</span>
          </div>
        </div>
      </div>

      <div class="form-group-row">
        <div class="form-group">
          <label for="direccion">Dirección</label>
          <input 
            type="text" id="direccion" formControlName="direccion"
            placeholder="Dirección del taller"
            [class.is-invalid]="tallerForm.get('direccion')?.invalid && tallerForm.get('direccion')?.touched">
          <div class="error-message" *ngIf="tallerForm.get('direccion')?.invalid && tallerForm.get('direccion')?.touched">
            <span>La dirección es requerida</span>
          </div>
        </div>

        <div class="form-group">
          <label for="codigoPostal">Código Postal</label>
          <input 
            type="text" id="codigoPostal" formControlName="codigoPostal"
            placeholder="12345"
            [class.is-invalid]="tallerForm.get('codigoPostal')?.invalid && tallerForm.get('codigoPostal')?.touched">
          <div class="error-message" *ngIf="tallerForm.get('codigoPostal')?.invalid && tallerForm.get('codigoPostal')?.touched">
            <span *ngIf="tallerForm.get('codigoPostal')?.errors?.['required']">Código postal requerido</span>
            <span *ngIf="tallerForm.get('codigoPostal')?.errors?.['pattern']">Debe tener 5 dígitos</span>
          </div>
        </div>
      </div>

      <div class="form-group-row">
        <div class="form-group">
          <label for="ciudad">Ciudad</label>
          <input 
            type="text" id="ciudad" formControlName="ciudad"
            placeholder="Ciudad"
            [class.is-invalid]="tallerForm.get('ciudad')?.invalid && tallerForm.get('ciudad')?.touched">
          <div class="error-message" *ngIf="tallerForm.get('ciudad')?.invalid && tallerForm.get('ciudad')?.touched">
            <span>La ciudad es requerida</span>
          </div>
        </div>

        <div class="form-group">
          <label for="provincia">Provincia</label>
          <input 
            type="text" id="provincia" formControlName="provincia"
            placeholder="Provincia"
            [class.is-invalid]="tallerForm.get('provincia')?.invalid && tallerForm.get('provincia')?.touched">
          <div class="error-message" *ngIf="tallerForm.get('provincia')?.invalid && tallerForm.get('provincia')?.touched">
            <span>La provincia es requerida</span>
          </div>
        </div>
      </div>

      <div class="form-group checkbox-group">
        <div class="checkbox-container">
          <input 
            type="checkbox" id="acceptTerms" formControlName="acceptTerms"
            [class.is-invalid]="tallerForm.get('acceptTerms')?.invalid && tallerForm.get('acceptTerms')?.touched">
          <label for="acceptTerms">Acepto los términos y condiciones</label>
        </div>
        <div class="error-message" *ngIf="tallerForm.get('acceptTerms')?.invalid && tallerForm.get('acceptTerms')?.touched">
          <span>Debe aceptar los términos y condiciones</span>
        </div>
      </div>

      <div class="form-actions" *ngIf="cliente.cif==null">
        <button type="button" class="btn-secondary" routerLink="/">Cancelar</button>
        <button type="submit" class="btn-primary" [disabled]="isSubmitting">
          {{ isSubmitting ? 'Registrando...' : 'Registrarse' }}
        </button>
      </div>
      <div class="form-actions" *ngIf="cliente.cif!=null">
        <button type="button" class="btn-secondary" routerLink="/">Cancelar</button>
        <button type="submit" class="btn-primary" [disabled]="isSubmitting">
          {{ isSubmitting ? 'Actualizando...' : 'Actualizar' }}
        </button>
      </div>

      <div class="login-link" *ngIf="cliente.cif==null">
        ¿Ya tienes una cuenta? <a routerLink="/login">Inicia sesión</a>
      </div>
    </form>
  </div>
</div>
